---
import "./normalize.css";
import "../../styles/global.scss";
import "./layaout.scss";
import SidebarMenu from "../../components/menu/SideBarMenu.astro";
import { navLinks } from "../../data/navigation.js";
// import { logo } from '../../assets/astro.svg'
import { ClientRouter } from "astro:transitions";
import Footer from "../../components/footer/Footer.astro";
import Image from "astro/components/Image.astro";
import MiniLogo from "../../assets/Logo/MiniLogo.svg";
import type { record } from "astro:schema";
// LÍNEA CORRECTA
// import toggleScript from '~/scripts/toogle.js?raw'; // no funciono, quizas los Weis pueda

// 1. Definir las props que el layout aceptará
interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title} | Click Alternativo</title>
    <meta name="description" content={description} />
    <ClientRouter />
  </head>
  <body>
    <!-- El Header contendrá la lógica de navegación principal -->
    <header class="main-header">
      <a href="/" class="header-logo">Click Alternativo</a>
      <!-- Botón hamburguesa (solo visible en móvil) -->
      <button
        id="hamburger-btn"
        class="hamburger-button"
        aria-label="Abrir/Cerrar menú"
        aria-expanded="false"
      >
        <span class="line line1"></span>
        <span class="line line2"></span>
        <span class="line line3"></span>
      </button>

      <!-- Menú de escritorio (solo visible en desktop) -->
      <nav class="desktop-nav">
        <a href="/" >
          <Image 
          class="desktop-nav-image"
          src={MiniLogo}
          alt="Mini Logo de Click Alternativo para la barra de navegación. Al hacer clic irás a la página de inicio."
          />
        </a>
        {navLinks?.map((link) => <a href={link.href}>{link.text}</a>)}
      </nav>
    </header>

    <main>
      <!-- El menú lateral y el overlay son elementos globales, no van en el main -->
      <SidebarMenu />
      <div id="sidebar-overlay" class="overlay"></div>

      <!-- El contenido de la página se renderiza aquí -->
      <slot />

      <!-- AÑADIR UN FOOTER PRINCIPAL -->
       <!-- CREAR EL FOOTER -->
      <!-- <footer class="site-footer"> 
        <p>
          © {new Date().getFullYear()} Cuajo Project. Todos los derechos reservados.
        </p>
        <a href="/politica-privacidad">Política de Privacidad</a>
      </footer> -->

    </main>
    <Footer />

    <script>
      function initMobileMenu() {
        const hamburgerBtn = document.getElementById("hamburger-btn");
        const sidebar = document.getElementById("sidebar-menu");
        const overlay = document.getElementById("sidebar-overlay");

        if (!hamburgerBtn || !sidebar || !overlay) {
          return;
        }

        const toggleSidebar = () => {
          const isOpen = sidebar.classList.contains("is-open");
          hamburgerBtn.setAttribute("aria-expanded", String(!isOpen));
          sidebar.classList.toggle("is-open");
          hamburgerBtn.classList.toggle("is-active");
        };

        const closeSidebar = () => {
          if (sidebar.classList.contains("is-open")) {
            toggleSidebar();
          }
        };

        hamburgerBtn.addEventListener("click", toggleSidebar);
        overlay.addEventListener("click", closeSidebar);

        const menuLinks = sidebar.querySelectorAll("a");
        menuLinks.forEach((link) => {
          link.addEventListener("click", closeSidebar);
        });
      }

      initMobileMenu();
      document.addEventListener("astro:after-swap", initMobileMenu);
    </script>
  </body>
</html>
